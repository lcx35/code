{% extends "base.html" %}
{% block content %}

            <div class="row">
                <div class="col-lg-12">
                    <h1 class="page-header">用户</h1>
                </div>
                <!-- /.col-lg-12 -->
            </div>
            <!-- /.row -->
            <div class="row">
                <div class="col-lg-12">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            用户列表<br />
                             <a href="/user/add"> 添加用户</a>
                        </div>
                        <!-- /.panel-heading -->
                        <div class="panel-body">
                            <div class="dataTable_wrapper">
                                <table class="table table-striped table-bordered table-hover" id="dataTables-example">
                                    <thead>
                                        <tr>
                                            <th>用户名</th>
                                            <th>所属人员</th>
                                            <th>操作</th>
                                        </tr>
                                    </thead>
                                    <tbody>
				{% for user in users %}
                                        <tr class="odd gradeX">
                                            <td>{{ user.name }}</td>
                                            <td>{{ user.master }}</td>
                                            <td>
						<a title="编辑" class="fa fa-edit fa-fw" href="/user/settings?u={{ user.name }}"></a>
						<a title="删除" class="fa fa-trash-o fa-fw" href="/user/del?u={{ user.name }}"></a>
					    </td>
                                        </tr>
				{% endfor %}
                                    </tbody>
                                </table>
                            </div>
                            <!-- /.table-responsive -->
        <div class="row">
	<div class="col-sm-12">
		<div class="paging_simple_numbers" style="text-align: right;">
			<ul name="pageZone" class="pagination">
			</ul>
		</div>
	</div>
	</div>
                        </div>
                        <!-- /.panel-body -->
                    </div>
                    <!-- /.panel -->
                </div>
                <!-- /.col-lg-12 -->
            </div>

<script type="text/javascript">
//container 容器，count 总页数 pageindex 当前页数
function setPage(container, count, pageindex) {
var container = container;
var count = count;
var pageindex = pageindex;
var a = [];

function setPageList() {
    if (pageindex == i) {
      a[a.length] = "<li class=\"paginate_button active\"><a href=\"#\">" + i + "</a></li>";
    } else {
      a[a.length] = "<li class=\"paginate_button\"><a href=\"?p=" + i +"\">" + i + "</a></li>";
    }
  }

  //总页数少于10 全部显示,大于10 显示前3 后3 中间3 其余....
  if (pageindex == 1) {
    a[a.length] = "<li class=\"paginate_button previous disabled\"><a href=\"#\">上一页</a></li>";
  } else {
    a[a.length] = "<li class=\"paginate_button previous\"><a href=\"?p=" + (pageindex-1) + "\">上一页</a></li>";
  }

  //总页数小于10
  if (count <= 10) {
    for (var i = 1; i <= count; i++) {
      setPageList();
    }
  }
  //总页数大于10页
  else {

    if (pageindex <= 4) {
      for (var i = 1; i <= 5; i++) {
        setPageList();
      }
      a[a.length] = "<li class=\"paginate_button\"><a>...</a></li><li class=\"paginate_button previous\"><a href=\"?p=" + count + "\">" + count + "</a></li>";
    } else if (pageindex >= count - 3) {
      a[a.length] = "<li class=\"paginate_button\"><a href=\"?p=1\">1</a></li><li class=\"paginate_button\"><a>...</a></li>";
      for (var i = count - 4; i <= count; i++) {
        setPageList();
      }
    }
    else { //当前页在中间部分
      a[a.length] = "<li class=\"paginate_button\"><a href=\"?p=1\">1</a></li><li class=\"paginate_button\"><a>...</a></li>";
      for (var i = pageindex - 2; i <= pageindex + 2; i++) {
        setPageList();
      }
      a[a.length] = "<li class=\"paginate_button\"><a>...</a></li><li class=\"paginate_button\"><a href=\"?p="+count+"\">" + count + "</a></li>";
    }

  }

  if (pageindex == count) {
    a[a.length] = "<li class=\"paginate_button next disabled\"><a href=\"#\">下一页</a></li>";
  } else {
    a[a.length] = "<li class=\"paginate_button next\"><a href=\"?p=" + (pageindex+1) + "\">下一页</a></li>";
  }
  container.innerHTML = a.join("");
  //事件点击
}
setPage(document.getElementsByName('pageZone')[0],{{ count }},{{ page }});
</script>

{% endblock %}
